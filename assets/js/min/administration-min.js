function initItems(){var t=51.541216,e=-.095678;AjaxHandler.request({url:"locations",method:"GET",success:function(t){fillVerwaltung(t)},error:function(t,e,a){console.log(errorThrownr)}}),$("#geocomplete").geocomplete({details:"#edit-form",types:["geocode","establishment"]})}function fillVerwaltung(t){var e=$("body").find(".items-list");console.log(t);for(var a=0;a<t.items.length;a++){var i=null!=window.location.href.match(/^(http.+\/)[^\/]+$/)?window.location.href.match(/^(http.+\/)[^\/]+$/)[1]:window.location;if(t.items[a].gallery)var d=t.items[a].gallery;else d=i+"/assets/img/default-item.png";e.append('<li><div class="item" id="'+t.items[a].id+'"><a href="#" class="image"><img src="'+d+'" alt=""></a><div class="wrapper"><figure>'+t.items[a].category+"</figure><h3>"+t.items[a].title+'</h3></div><div class="col-md-12 item-footer"><div class="col-md-6"><span class="meta-element hidden" id="'+t.items[a].id+'" data-gallery="'+t.items[a].gallery+'" data-longitude="'+t.items[a].longitude+'" data-latitude="'+t.items[a].latitude+'" data-title="'+t.items[a].title+'" data-type="'+t.items[a].type+'"  data-category="'+t.items[a].category+'" data-location="'+t.items[a].location+'" data-aperture="'+t.items[a].aperture+'" data-date="'+t.items[a].dateCreated+'" data-focal="'+t.items[a].focal+'" data-iso="'+t.items[a].iso+'" data-rating="'+t.items[a].rating+'"><h3>'+t.items[a].title+'</h3></span><a href="#" class="btn btn-default btn-edit">Edit</a></div><div class="col-md-6"><a href="#" class="btn btn-red btn-delete">Delete</a></div></div></div></li>')}}function showDeleteModal(){function t(t){var e=t;deleteModal(e);var a=$("#delete-modal");a.removeClass("hide"),a.addClass("fade-in"),$("#delete-modal .modal-close").on("click",function(){a.addClass("hide"),a.removeClass("fade-in")})}$("body").on("click",".btn-delete",function(e){var a=$(this).closest(".item").find(".meta-element");t(a)})}function editModal(t){function e(t){var e=$("#edit-modal form"),a=e.find("input[type='file']");if(""==a.val())return void("function"==typeof callback&&callback());e.attr("action","locations/"+t+"/image");var i=$("#fnJS_iframe_location_attachment");i.unbind().load(function(t){t.preventDefault(),callback($(this).contents())}),e.submit()}fancySelect();var a=$("#edit-modal"),i=t.data("title"),d=t.data("latitude"),l=t.data("longitude"),o=t.data("gallery"),n=t.data("category"),s=t.data("date"),c=t.data("aperture"),r=t.data("focal"),m=t.data("iso"),f=t.data("rating"),u=t.attr("id"),h=a.find("form").attr("action");a.find("form").attr("action",h+u),a.find("#title").val(i),a.find("#category").val(n),a.find("#date").val(s),a.find("#aperture").val(c),a.find("#focal").val(r),a.find("#iso").val(m),a.find("#lng").val(l),a.find("#lat").val(d),a.find("#rating").val(f),a.find("form").on("submit",function(t){t.preventDefault(),AjaxHandler.request({method:"PUT",cache:!1,url:$(this).attr("action"),data:$(this).serializeObject(),success:function(t){e(t.id),location.reload(!0)},error:function(t){console.log(t)}})}),$("#geocomplete-edit").geocomplete({details:"#edit-form",types:["geocode","establishment"]})}function deleteModal(t){var e=$("#delete-modal"),a=t.attr("id"),i=t.data("title"),d=e.find("form").attr("action");e.find("form").attr("action",d+a),e.find(".location").text(i),e.find("form").on("submit",function(t){t.preventDefault(),AjaxHandler.request({method:"DELETE",cache:!1,url:$(this).attr("action"),data:$(this).serialize(),success:function(t){console.log("deleted"),location.reload(!0)}})})}function userAdministration(){function t(){var t=$("#user-modal");t.removeClass("hide"),t.addClass("fade-in"),$("#user-modal .modal-close").on("click",function(){t.addClass("hide"),t.removeClass("fade-in")}),a(),e(t)}function e(t){t.find("form").on("submit",function(t){t.preventDefault(),AjaxHandler.request({method:"POST",cache:!1,url:$(this).attr("action"),data:$(this).serializeObject(),success:function(t){a()}})})}function a(){function t(t){console.log(t);for(var e=0;e<t.items.length;e++){var a=$("#user-modal table.userlist tbody");a.empty(),a.append('<tr><td class="id">'+t.items[e].id+'</td><td class="id">'+t.items[e].email+'</td><td class="id">'+t.items[e].password+'</td><td class="id">'+t.items[e].firstName+'</td><td class="id">'+t.items[e].lastName+'</td><td class="id">'+t.items[e].companyName+'</td><td class="id">'+t.items[e].roles+"</td></tr>")}}AjaxHandler.request({method:"GET",cache:!1,url:"users",data:$(this).serialize(),success:function(e){t(e)}})}$("body").on("click","#useradmin-link",function(e){t()})}$(document).ready(function(){initItems(),showEditModal(),showDeleteModal(),menuItemHandler(),submitItem(),setInputsWidth(),fancySelect(),userAdministration()});
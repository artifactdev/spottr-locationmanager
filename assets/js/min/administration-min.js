!function($,t,a){spottr.administration={initItems:function(){var t=51.541216,a=-.095678;AjaxHandler.request({url:"locations",method:"GET",success:function(t){spottr.administration.fillVerwaltung(t)},error:function(t,a,e){console.log(errorThrownr)}}),$("#geocomplete").geocomplete({details:"#edit-form",types:["geocode","establishment"]})},fillVerwaltung:function(a){var e=$("body").find(".items-list");console.log(a);for(var i=0;i<a.items.length;i++){var o=null!=t.location.href.match(/^(http.+\/)[^\/]+$/)?t.location.href.match(/^(http.+\/)[^\/]+$/)[1]:t.location;if(a.items[i].gallery)var l=a.items[i].gallery;else l=o+"/assets/img/default-item.png";e.append('<li><div class="item" id="'+a.items[i].id+'"><a href="#" class="image"><img src="'+l+'" alt=""></a><div class="wrapper"><figure>'+a.items[i].category+"</figure><h3>"+a.items[i].title+'</h3></div><div class="col-md-12 item-footer"><div class="col-md-6"><span class="meta-element hidden" id="'+a.items[i].id+'" data-gallery="'+a.items[i].gallery+'" data-longitude="'+a.items[i].longitude+'" data-latitude="'+a.items[i].latitude+'" data-title="'+a.items[i].title+'" data-type="'+a.items[i].type+'"  data-category="'+a.items[i].category+'" data-location="'+a.items[i].location+'" data-aperture="'+a.items[i].aperture+'" data-date="'+a.items[i].dateCreated+'" data-focal="'+a.items[i].focal+'" data-iso="'+a.items[i].iso+'" data-rating="'+a.items[i].rating+'"><h3>'+a.items[i].title+'</h3></span><a href="#" class="btn btn-default btn-edit">Edit</a></div><div class="col-md-6"><a href="#" class="btn btn-red btn-delete">Delete</a></div></div></div></li>')}},showDeleteModal:function(){$("body").on("click",".btn-delete",function(t){var a=$(this).closest(".item").find(".meta-element"),e=$("#delete-modal");spottr.administration.deleteModal(a)})},editModal:function(t){spottr.global.fancySelect();var a=$("#edit-modal"),e=t.data("title"),i=t.data("latitude"),o=t.data("longitude"),l=t.data("gallery"),n=t.data("category"),d=t.data("date"),s=t.data("aperture"),r=t.data("focal"),c=t.data("iso"),m=t.data("rating"),f=t.attr("id"),u=a.find("form").attr("action");a.find("form").attr("action",u+f),a.find("#title").val(e),a.find("#category").val(n),a.find("#date").val(d),a.find("#aperture").val(s),a.find("#focal").val(r),a.find("#iso").val(c),a.find("#lng").val(o),a.find("#lat").val(i),a.find("#rating").val(m),a.find("form").on("submit",function(t){t.preventDefault(),AjaxHandler.request({method:"PUT",cache:!1,url:$(this).attr("action"),data:$(this).serializeObject(),success:function(t){submitImage(t.id),location.reload(!0)},error:function(t){console.log(t)}})}),spottr.administration.submitImage(locationID),$("#geocomplete-edit").geocomplete({details:"#edit-form",types:["geocode","establishment"]})},submitImage:function(t){var a=$("#edit-modal form"),e=a.find("input[type='file']");if(""==e.val())return void("function"==typeof callback&&callback());a.attr("action","locations/"+t+"/image");var i=$("#fnJS_iframe_location_attachment");i.unbind().load(function(t){t.preventDefault(),callback($(this).contents())}),a.submit()},deleteModal:function(t){var a=$("#delete-modal");spottr.global.modalHandler(a);var e=t.attr("id"),i=t.data("title"),o=a.find("form").attr("action");a.find("form").attr("action",o+e),a.find(".location").text(i),a.find("form").on("submit",function(t){t.preventDefault(),AjaxHandler.request({method:"DELETE",cache:!1,url:$(this).attr("action"),data:$(this).serialize(),success:function(t){console.log("deleted"),location.reload(!0)}})})}}}(jQuery,this),$(document).ready(function(){spottr.administration.initItems(),spottr.global.showEditModal(),spottr.administration.showDeleteModal(),spottr.global.menuItemHandler(),spottr.global.submitItem(),spottr.global.setInputsWidth(),spottr.global.fancySelect()});
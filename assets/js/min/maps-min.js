"use strict";function createHomepageGoogleMap(e,t,o){function a(){function a(e,t){var a=new Image,n=$(".results li #"+o.items[t].id+" .image");a.src=e,a.complete?$(".results").each(function(){n.removeClass("loading"),n.addClass("loaded")}):($(".results").each(function(){$(".results li #"+o.items[t].id+" .image").addClass("loading")}),$(a).load(function(){n.removeClass("loading"),n.addClass("loaded")}))}for(var n=new google.maps.LatLng(e,t),s={zoom:12,center:n,disableDefaultUI:!1,scrollwheel:!1,styles:mapStyles,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.HORIZONTAL_BAR,position:google.maps.ControlPosition.BOTTOM_CENTER},panControl:!1,zoomControl:!0,zoomControlOptions:{style:google.maps.ZoomControlStyle.LARGE,position:google.maps.ControlPosition.RIGHT_TOP}},i=document.getElementById("map"),l=new google.maps.Map(i,s),r=[],m=0,c=!1,d=!1,p=0;p<o.items.length;p++){if(o.items[p].color)var g=o.items[p].color;else g="";var u=document.createElement("DIV"),f=null!=window.location.href.match(/^(http.+\/)[^\/]+$/)?window.location.href.match(/^(http.+\/)[^\/]+$/)[1]:window.location;u.innerHTML='<div class="map-marker" data-id="'+o.items[p].id+'"><div class="icon"><img src="'+f+o.items[p].type+'"></div></div>';var y=new RichMarker({position:new google.maps.LatLng(o.items[p].latitude,o.items[p].longitude),map:l,draggable:!1,content:u,flat:!0});r.push(y);var v=document.createElement("div"),T={content:v,disableAutoPan:!1,pixelOffset:new google.maps.Size(-18,-42),zIndex:null,alignBottom:!0,boxClass:"infobox",enableEventPropagation:!0,closeBoxMargin:"0px 0px -30px 0px",closeBoxURL:"assets/img/close.png",infoBoxClearance:new google.maps.Size(1,1)},h=o.items[p].category;v.innerHTML=drawInfobox(h,v,o,p),r[p].infobox=new InfoBox(T),google.maps.event.addListener(y,"click",function(e,t){return function(){if(google.maps.event.addListener(l,"click",function(e){d=r[t]}),c=r[t],c!=d){for(var e=0;e<r.length;e++)r[e].content.className="marker-loaded",r[e].infobox.close();r[t].infobox.open(l,this),r[t].infobox.setOptions({boxClass:"fade-in-marker"}),r[t].content.className="marker-active marker-loaded",m=1}spottr.main.showModal()}}(y,p)),google.maps.event.addListener(r[p].infobox,"closeclick",function(e,t){return function(){c=0,r[t].content.className="marker-loaded",r[t].infobox.setOptions({boxClass:"fade-out-marker"})}}(y,p))}google.maps.event.addListener(l,"click",function(e){0!=c&&0!=d&&(1==m?(c.infobox.open(l),c.infobox.setOptions({boxClass:"fade-in-marker"}),c.content.className="marker-active marker-loaded"):(m=0,c.infobox.setOptions({boxClass:"fade-out-marker"}),c.content.className="marker-loaded",setTimeout(function(){c.infobox.close()},350)),m=0),0!=c&&google.maps.event.addListener(c,"click",function(e){m=1}),m=0});var b=[{url:"assets/img/cluster.png",height:34,width:34}],w=new MarkerClusterer(l,r,{styles:b,maxZoom:19});google.maps.event.addListener(l,"idle",function(){for(var e=[],t=0;t<o.items.length;t++)l.getBounds().contains(r[t].getPosition())?(e.push(r[t]),$.each(e,function(t){setTimeout(function(){l.getBounds().contains(e[t].getPosition())&&(e[t].content.className||(e[t].setMap(l),e[t].content.className+="bounce-animation marker-loaded",w.repaint()))},50*t)})):(r[t].content.className="",r[t].setMap(null));var n=[];$.each(o.items,function(e){if(l.getBounds().contains(new google.maps.LatLng(o.items[e].latitude,o.items[e].longitude))){var t=o.items[e].category;spottr.main.pushItemsToArray(o,e,t,n)}}),$(".items-list .results").html(n),$.each(o.items,function(e){l.getBounds().contains(new google.maps.LatLng(o.items[e].latitude,o.items[e].longitude))&&a(o.items[e].gallery,e)}),spottr.global.rating()}),redrawMap("google",l)}$.get("./assets/js/_infobox.js",function(){a()})}function itemDetailMap(e){var t=new google.maps.LatLng(e.latitude,e.longitude),o={zoom:14,center:t,disableDefaultUI:!0,scrollwheel:!1,styles:mapStyles,panControl:!1,zoomControl:!1,draggable:!0},a=document.getElementById("map-detail"),n=new google.maps.Map(a,o);if(e.type)var s='<img src="'+e.type+'">';else s="";var i=document.createElement("DIV");i.innerHTML='<div class="map-marker"><div class="icon">'+s+"</div></div>";var l=new RichMarker({position:new google.maps.LatLng(e.latitude,e.longitude),map:n,draggable:!1,content:i,flat:!0});l.content.className="marker-loaded"}function centerMapToMarker(){$.each(json.items,function(e){if(json.items[e].id==id){var t=json.items[e].latitude,o=json.items[e].longitude,a=new google.maps.LatLng(t,o);map.setCenter(a)}})}function redrawMap(e,t){$(".map .toggle-navigation").click(function(){$(".map-canvas").toggleClass("results-collapsed"),$(".map-canvas .map").one("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){"google"==e&&google.maps.event.trigger(t,"resize")})})}var $=jQuery.noConflict(),mapStyles=[{featureType:"road",elementType:"labels",stylers:[{visibility:"simplified"},{lightness:20}]},{featureType:"administrative.land_parcel",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"landscape.man_made",elementType:"all",stylers:[{visibility:"on"}]},{featureType:"transit",elementType:"all",stylers:[{saturation:-100},{visibility:"on"},{lightness:10}]},{featureType:"road.local",elementType:"all",stylers:[{visibility:"on"}]},{featureType:"road.local",elementType:"all",stylers:[{visibility:"on"}]},{featureType:"road.highway",elementType:"labels",stylers:[{visibility:"simplified"}]},{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road.arterial",elementType:"labels",stylers:[{visibility:"on"},{lightness:50}]},{featureType:"water",elementType:"all",stylers:[{hue:"#a1cdfc"},{saturation:30},{lightness:49}]},{featureType:"road.highway",elementType:"geometry",stylers:[{hue:"#f49935"}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{hue:"#fad959"}]},{featureType:"road.highway",elementType:"all",stylers:[{hue:"#dddbd7"},{saturation:-92},{lightness:60},{visibility:"on"}]},{featureType:"landscape.natural",elementType:"all",stylers:[{hue:"#c8c6c3"},{saturation:-71},{lightness:-18},{visibility:"on"}]},{featureType:"poi",elementType:"all",stylers:[{hue:"#d9d5cd"},{saturation:-70},{lightness:20},{visibility:"on"}]}];
var path=null!=window.location.href.match(/^(http.+\/)[^\/]+$/)?window.location.href.match(/^(http.+\/)[^\/]+$/)[1]:window.location,_latitude=51.0545032,_longitude=13.7416008,spottr={};!function($,t,o){spottr.global={showEditModal:function(){$("body").on("click",".btn-edit",function(t){var o=$(this).closest(".item").find(".meta-element"),a=$("#edit-modal");spottr.global.modalHandler(a),spottr.administration.editModal(o)})},modalHandler:function(t){var o=t;o.removeClass("hide"),o.addClass("fade-in");var a=o.find("form"),n=a.length;n>=1&&a.validate(),o.find(".modal-close").on("click",function(){o.addClass("hide"),o.removeClass("fade-in"),n>=1&&(a.validate().resetForm(),a.find(".tooltip").addClass("hide"))})},fancySelect:function(){var t=$("select");t.length>0&&t.selectpicker();var o=$(".bootstrap-select"),a=$(".dropdown-menu");o.on("shown.bs.dropdown",function(){a.removeClass("animation-fade-out"),a.addClass("animation-fade-in")}),o.on("hide.bs.dropdown",function(){a.removeClass("animation-fade-in"),a.addClass("animation-fade-out")}),o.on("hidden.bs.dropdown",function(){var t=$(this);$(t).addClass("open"),setTimeout(function(){$(t).removeClass("open")},100)})},menuItemHandler:function(){var t=$("body.page-verwaltung").length,o=$("body.page-homepage").length;t&&$("#useradmin-link").removeClass("hide"),o&&$("#admin-link").removeClass("hide")},loadExifData:function(){var t=function(t){if(t){var o=t.GPSLatitude,a=t.GPSLongitude,n=t.ApertureValue,e=t.FocalLength,i=t.ISOSpeedRatings;$("#lng").val(a),$("#lat").val(o),$("#aperture").val(n),$("#focal").val(e),$("#iso").val(i),console.log(t)}};try{$("#file").change(function(){$(this).fileExif(t)})}catch(o){console.log(o)}},rating:function(t,o,a,n){t="undefined"!=typeof t?t:$(".rating"),o="undefined"!=typeof o?o:"xs",a="undefined"!=typeof a?a:!1,n="undefined"!=typeof n?n:!1,t.rating({size:o,showCaption:a,showClear:n})},searchFilter:function(){},submitItem:function(){var t=$("body").find("#add-modal"),o=$("#add-form");$(".submit-item").on("click",function(){spottr.global.modalHandler(t),spottr.global.fancySelect()}),spottr.global.loadExifData(),$("#geocomplete-search").geocomplete({details:"#add-form",types:["geocode","establishment"],detailsAttribute:"data-geo"}),t.find("#add-form").on("submit",function(t){t.preventDefault(),AjaxHandler.request({method:"POST",cache:!1,url:$(this).attr("action"),data:$(this).serializeObject(),success:function(t){var o=$("#add-form-image");spottr.global.submitImage(t.id,o)},error:function(t){console.log(t)}})})},submitImage:function(t,a){var n=a.find("input[type='file']");if(""==n.val()||t==o)return void location.reload(!0);a.attr("action","rest-api/locations/"+t+"/image");var e=$("#js_iframe_location_attachment");e.unbind().load(function(t){t.preventDefault(),location.reload(!0)}),a.submit()},setInputsWidth:function(){for(var t=$(".search-bar.horizontal .input-row"),o=0;o<t.length;o++)t.find($('button[type="submit"]')).length&&t.find(".form-group:last").css("width","initial");for(var a=$(".search-bar.horizontal .form-group"),n=0;n<a.length;n++)$(".main-search").addClass(a.length<=2?"inputs-1":a.length<=3?"inputs-2":a.length<=4?"inputs-3":a.length<=5?"inputs-4":a.length<=6?"inputs-5":"inputs-4"),$(".search-bar.horizontal .form-group label").length>0&&$(".search-bar.horizontal .form-group:last-child button").css("margin-top",25)},goToIndex:function(){var o=t.location.href,a=path+"index.php",n=path+"login.php";o===n&&t.location.replace(a)},goToLogin:function(){var o=t.location.href,a=path+"login.php";o!=a&&t.location.replace(a)}}}(jQuery,this);
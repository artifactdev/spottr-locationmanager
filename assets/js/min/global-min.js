var path=null!=window.location.href.match(/^(http.+\/)[^\/]+$/)?window.location.href.match(/^(http.+\/)[^\/]+$/)[1]:window.location,_latitude=51.0545032,_longitude=13.7416008,spottr={};!function($,t,a){spottr.global={showEditModal:function(){$("body").on("click",".btn-edit",function(t){var a=$(this).closest(".item").find(".meta-element"),o=$("#edit-modal");spottr.global.modalHandler(o),spottr.administration.editModal(a)})},modalHandler:function(t){var a=t;a.removeClass("hide"),a.addClass("fade-in");var o=a.find("form"),n=o.length;n>=1&&o.validate(),a.find(".modal-close").on("click",function(){a.addClass("hide"),a.removeClass("fade-in"),n>=1&&(o.validate().resetForm(),o.find(".tooltip").addClass("hide"))})},fancySelect:function(){var t=$("select");t.length>0&&t.selectpicker();var a=$(".bootstrap-select"),o=$(".dropdown-menu");a.on("shown.bs.dropdown",function(){o.removeClass("animation-fade-out"),o.addClass("animation-fade-in")}),a.on("hide.bs.dropdown",function(){o.removeClass("animation-fade-in"),o.addClass("animation-fade-out")}),a.on("hidden.bs.dropdown",function(){var t=$(this);$(t).addClass("open"),setTimeout(function(){$(t).removeClass("open")},100)})},menuItemHandler:function(){var t=$("body.page-verwaltung").length,a=$("body.page-homepage").length;t&&$("#useradmin-link").removeClass("hide"),a&&$("#admin-link").removeClass("hide")},loadExifData:function(){var t=function(t){if(t){var a=t.GPSLatitude,o=t.GPSLongitude,n=t.ApertureValue,e=t.FocalLength,i=t.ISOSpeedRatings;$("#lng").val(o),$("#lat").val(a),$("#aperture").val(n),$("#focal").val(e),$("#iso").val(i),console.log(t)}};try{$("#file").change(function(){$(this).fileExif(t)})}catch(a){console.log(a)}},searchFilter:function(){},submitItem:function(){var t=$("body").find("#add-modal"),a=$("#add-form");$(".submit-item").on("click",function(){spottr.global.modalHandler(t),spottr.global.fancySelect()}),spottr.global.loadExifData(),spottr.global.markerToPosition("#map-add"),$("#geocomplete-search").geocomplete({details:"#add-form",types:["geocode","establishment"],detailsAttribute:"data-geo"}),t.find("#add-form").on("submit",function(t){t.preventDefault(),AjaxHandler.request({method:"POST",cache:!1,url:$(this).attr("action"),data:$(this).serializeObject(),success:function(t){var a=$("#add-form-image");spottr.global.submitImage(t.id,a)},error:function(t){console.log(t)}})})},submitImage:function(t,o){var n=o.find("input[type='file']");if(""==n.val()||t==a)return void location.reload(!0);o.attr("action","rest-api/locations/"+t+"/image");var e=$("#js_iframe_location_attachment");e.unbind().load(function(t){t.preventDefault(),location.reload(!0)}),o.submit()},markerToPosition:function(t){var a;$(document).ready(function(){a=new GMaps({div:t,lat:_latitude,lng:_longitude}),GMaps.on("click",a.map,function(t){var o=a.markers.length,n=t.latLng.lat(),e=t.latLng.lng(),i=template.replace(/{{index}}/g,o).replace(/{{lat}}/g,n).replace(/{{lng}}/g,e);console.log(n),console.log(e),a.addMarker({lat:n,lng:e,title:"Marker #"+o,infoWindow:{content:i}})})})},setInputsWidth:function(){for(var t=$(".search-bar.horizontal .input-row"),a=0;a<t.length;a++)t.find($('button[type="submit"]')).length&&t.find(".form-group:last").css("width","initial");for(var o=$(".search-bar.horizontal .form-group"),n=0;n<o.length;n++)$(".main-search").addClass(o.length<=2?"inputs-1":o.length<=3?"inputs-2":o.length<=4?"inputs-3":o.length<=5?"inputs-4":o.length<=6?"inputs-5":"inputs-4"),$(".search-bar.horizontal .form-group label").length>0&&$(".search-bar.horizontal .form-group:last-child button").css("margin-top",25)},goToIndex:function(){var a=t.location.href,o=path+"index.php",n=path+"login.php";a===n&&t.location.replace(o)},goToLogin:function(){var a=t.location.href,o=path+"login.php";a!=o&&t.location.replace(o)}}}(jQuery,this);